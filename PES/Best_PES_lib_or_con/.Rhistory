PRS <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.validate.rds")
PRS_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.lassosum.pipeline.rds")
PRS_weights <- cbind(PRS_pipeline$sumstats, PRS$best.beta)
SZ_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/QC_sumstats/SZ_PGC3_NO_ASRB_QC_sumstats.txt", header = T)
library(data.table)
library(dplyr)
SZ_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/QC_sumstats/SZ_PGC3_NO_ASRB_QC_sumstats.txt", header = T)
SZ_sumstats$order <-  seq.int(nrow(SZ_sumstats))
Merged_PRS <- merge(PRS_weights, SZ_sumstats, by = "order")
PRS_output <- Merged_PRS %>% select(SNP, A1.x, 'PRS$best.beta')
PRS_output <- rename(PRS_output, "A1"="A1.x", "SZ_PRS"="PRS$best.beta")
write.table(PRS_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_SZ_SNP_weights_for_validation/SZ_PRS_penalised_reg_weights.txt",
row.names = F, quote = F)
write.table(PRS_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/SZ_PRS_penalised_reg_weights.txt",
row.names = F, quote = F)
write.table(PRS_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_SZ_PRS_penalised_reg_weights.txt",
row.names = F, quote = F)
CACNA1C_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/UKBB_SZ/SZ_UKBB_SZ_PGC3_ALL_CACNA1C_network.snp", header = T)
CACNA1C_SNPs_to_include <- CACNA1C_SNPs_to_include %>% filter(P < 0.005)
CACNA1C_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/SZ_PGC3_ALL_CACNA1C_network.txt", header = T)
CACNA1C_sum_stats$Beta <- log(CACNA1C_sum_stats$OR)
Merged_CACNA1C <- merge(CACNA1C_sum_stats, CACNA1C_SNPs_to_include, by = "SNP")
CACNA1C_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/UKBB_SZ/SZ_UKBB_SZ_PGC3_ALL_CACNA1C_network.snp", header = T)
CACNA1C_SNPs_to_include <- CACNA1C_SNPs_to_include %>% filter(P < 0.005)
CACNA1C_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_CACNA1C", header = T)
CACNA1C_sum_stats$Beta <- log(CACNA1C_sum_stats$OR)
Merged_CACNA1C <- merge(CACNA1C_sum_stats, CACNA1C_SNPs_to_include, by = "SNP")
CACNA1C_output <- Merged_CACNA1C %>% select(SNP, A1, Beta)
CACNA1C_output <- rename(CACNA1C_output, "CACNA1C_PES"="Beta")
write.table(CACNA1C_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_CACNA1C_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
FADS1_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/UKBB_SZ/SZ_UKBB_SZ_PGC3_ALL_FADS1_network.snp", header = T)
FADS1_SNPs_to_include <- FADS1_SNPs_to_include %>% filter(P < 0.05)
FADS1_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_FADS1", header = T)
FADS1_sum_stats$Beta <- log(FADS1_sum_stats$OR)
Merged_FADS1 <- merge(FADS1_sum_stats, FADS1_SNPs_to_include, by = "SNP")
FADS1_output <- Merged_FADS1 %>% select(SNP, A1, Beta)
FADS1_output <- rename(FADS1_output, "FADS1_PES"="Beta")
write.table(FADS1_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_removed_FADS1_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
FES_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/SZ_UKBB_liberal/SZ_UKBB_FES.snp", header = T)
FES_SNPs_to_include <- FES_SNPs_to_include %>% filter(P < 0.05)
FES_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/Liberal_boundaries_pathway_specific_variants/Liberal_bound_NO_ASRB_PGC3_FES", header = T)
FES_sum_stats$Beta <- log(FES_sum_stats$OR)
Merged_FES <- merge(FES_sum_stats, FES_SNPs_to_include, by = "SNP")
FES_output <- Merged_FES %>% select(SNP, A1, Beta)
FES_output <- rename(FES_output, "FES_PES"="Beta")
write.table(FES_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_FES_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
GRIN2A <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/ASRB_GRIN2A_lassosum_training/ASRB_removed_SZ_UKBB_LASSO_GRIN2A.validate.rds")
GRIN2A_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/ASRB_GRIN2A_lassosum_training/ASRB_removed_SZ_UKBB_LASSO_GRIN2A.lassosum.pipeline.rds")
GRIN2A_weights <- cbind(GRIN2A_pipeline$sumstats, GRIN2A$best.beta)
NZ <- GRIN2A_weights %>% filter(GRIN2A$best.beta != 0)
GRIN2A_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/Liberal_boundaries_pathway_specific_variants/Liberal_bound_NO_ASRB_PGC3_GRIN2A", header = T)
GRIN2A_sumstats$order <-  seq.int(nrow(GRIN2A_sumstats))
Merged_GRIN2A <- merge(GRIN2A_weights, GRIN2A_sumstats, by = "order")
GRIN2A_output <- Merged_GRIN2A %>% select(SNP, A1.x, 'GRIN2A$best.beta')
GRIN2A_output <- rename(GRIN2A_output, "GRIN2A_PES"="GRIN2A$best.beta", "A1"="A1.x")
write.table(GRIN2A_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_GRIN2A_PES_penalised_reg_weights.txt",
row.names = F, quote = F)
PRS <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.validate.rds")
PRS_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.lassosum.pipeline.rds")
PRS_weights <- cbind(PRS_pipeline$sumstats, PRS$best.beta)
SZ_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/QC_sumstats/SZ_PGC3_NO_ASRB_QC_sumstats.txt", header = T)
SZ_sumstats$order <-  seq.int(nrow(SZ_sumstats))
Merged_PRS <- merge(PRS_weights, SZ_sumstats, by = "order")
PRS_weights <- cbind(PRS_pipeline$sumstats, PRS$best.beta)
PRS <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.validate.rds")
PRS_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/ASRB_removed_lassosum_SZ_UKBB_TRAIN/SZ_UKBB_LASSO_PRS_ASRB_removed.lassosum.pipeline.rds")
PRS_weights <- cbind(PRS_pipeline$sumstats, PRS$best.beta)
SZ_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/QC_sumstats/SZ_PGC3_NO_ASRB_QC_sumstats.txt", header = T)
SZ_sumstats$order <-  seq.int(nrow(SZ_sumstats))
Merged_PRS <- merge(PRS_weights, SZ_sumstats, by = "order")
PRS_output <- Merged_PRS %>% select(CHR:BP, A1.x, 'PRS$best.beta')
head(PRS_output)
PRS_output <- Merged_PRS %>% select('CHR:BP', A1.x, 'PRS$best.beta')
head(PRS_output)
PRS_output <- rename(PRS_output, "A1"="A1.x", "SZ_PRS"="PRS$best.beta", "SNP"="CHR:BP")
head(PRS_output)
write.table(PRS_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_SZ_PRS_penalised_reg_weights.txt",
row.names = F, quote = F)
CACNA1C_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/UKBB_SZ/SZ_UKBB_SZ_PGC3_ALL_CACNA1C_network.snp", header = T)
CACNA1C_SNPs_to_include <- CACNA1C_SNPs_to_include %>% filter(P < 0.005)
CACNA1C_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_CACNA1C", header = T)
CACNA1C_sum_stats$Beta <- log(CACNA1C_sum_stats$OR)
Merged_CACNA1C <- merge(CACNA1C_sum_stats, CACNA1C_SNPs_to_include, by = "SNP")
CACNA1C_output <- Merged_CACNA1C %>% select('CHR:BP', A1, Beta)
CACNA1C_output <- rename(CACNA1C_output, "CACNA1C_PES"="Beta", "SNP"="CHR:BP")
head(CACNA1C_output)
write.table(CACNA1C_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_CACNA1C_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
FADS1_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/UKBB_SZ/SZ_UKBB_SZ_PGC3_ALL_FADS1_network.snp", header = T)
FADS1_SNPs_to_include <- FADS1_SNPs_to_include %>% filter(P < 0.05)
FADS1_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_FADS1", header = T)
FADS1_sum_stats$Beta <- log(FADS1_sum_stats$OR)
Merged_FADS1 <- merge(FADS1_sum_stats, FADS1_SNPs_to_include, by = "SNP")
FADS1_output <- Merged_FADS1 %>% select('CHR:BP', A1, Beta)
FADS1_output <- rename(FADS1_output, "FADS1_PES"="Beta", "SNP"="CHR:BP")
write.table(FADS1_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_removed_FADS1_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
FES_SNPs_to_include <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/SZ_UKBB_liberal/SZ_UKBB_FES.snp", header = T)
FES_SNPs_to_include <- FES_SNPs_to_include %>% filter(P < 0.05)
FES_sum_stats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/Liberal_boundaries_pathway_specific_variants/Liberal_bound_NO_ASRB_PGC3_FES", header = T)
FES_sum_stats$Beta <- log(FES_sum_stats$OR)
Merged_FES <- merge(FES_sum_stats, FES_SNPs_to_include, by = "SNP")
FES_output <- Merged_FES %>% select("CHR:BP", A1, Beta)
FES_output <- rename(FES_output, "FES_PES"="Beta", "SNP"="CHR:BP")
write.table(FES_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_FES_PES_SZ_cons_C_T.txt",
row.names = F, quote = F)
GRIN2A <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/ASRB_GRIN2A_lassosum_training/ASRB_removed_SZ_UKBB_LASSO_GRIN2A.validate.rds")
GRIN2A_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/ASRB_GRIN2A_lassosum_training/ASRB_removed_SZ_UKBB_LASSO_GRIN2A.lassosum.pipeline.rds")
GRIN2A_weights <- cbind(GRIN2A_pipeline$sumstats, GRIN2A$best.beta)
NZ <- GRIN2A_weights %>% filter(GRIN2A$best.beta != 0)
GRIN2A_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/Liberal_genic_boundaries_DA_gene_PES/Liberal_boundaries_pathway_specific_variants/Liberal_bound_NO_ASRB_PGC3_GRIN2A", header = T)
GRIN2A_sumstats$order <-  seq.int(nrow(GRIN2A_sumstats))
Merged_GRIN2A <- merge(GRIN2A_weights, GRIN2A_sumstats, by = "order")
GRIN2A_output <- Merged_GRIN2A %>% select('CHR:BP', A1.x, 'GRIN2A$best.beta')
GRIN2A_output <- rename(GRIN2A_output, "GRIN2A_PES"="GRIN2A$best.beta", "A1"="A1.x", "SNP"="CHR:BP")
write.table(GRIN2A_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_GRIN2A_PES_penalised_reg_weights.txt",
row.names = F, quote = F)
PCCB <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/Lassosum_SZ_UKBB/SZ_UKBB_LASSO_SZ_PGC3_ALL_PCCB_network.validate.rds")
PCCB_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/Lassosum_SZ_UKBB/SZ_UKBB_LASSO_SZ_PGC3_ALL_PCCB_network.lassosum.pipeline.rds")
PCCB_weights <- cbind(PCCB_pipeline$sumstats, PCCB$best.beta)
PCCB_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_PCCB", header = T)
PCCB_sumstats$order <-  seq.int(nrow(PCCB_sumstats))
Merged_PCCB <- merge(PCCB_weights, PCCB_sumstats, by = "order")
PCCB_output <- Merged_PCCB %>% select('CHR:BP', A1.x, 'PCCB$best.beta')
PCCB_output <- rename(PCCB_output, "SNP"="CHR:BP", "PCCB_PES"="PCCB$best.beta", "A1"="A1.x")
write.table(PCCB_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_PCCB_PES_penalised_reg_weights.txt",
row.names = F, quote = F)
RPS17 <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/Lassosum_SZ_UKBB/SZ_UKBB_LASSO_SZ_PGC3_ALL_RPS17_network.validate.rds")
RPS17_pipeline <- readRDS("~/Desktop/SZ_PES_mtCOJO_norm/PES/Lassosum_SZ_UKBB/SZ_UKBB_LASSO_SZ_PGC3_ALL_RPS17_network.lassosum.pipeline.rds")
RPS17_weights <- cbind(RPS17_pipeline$sumstats, RPS17$best.beta)
RPS17_sumstats <- fread("~/Desktop/SZ_PES_mtCOJO_norm/PES/Pathway_specific_variants/NO_ASRB_SZ_PGC3_RPS17", header = T)
RPS17_sumstats$order <-  seq.int(nrow(RPS17_sumstats))
Merged_RPS17 <- merge(RPS17_weights, RPS17_sumstats, by = "order")
RPS17_output <- Merged_RPS17 %>% select('CHR:BP', A1.x, 'RPS17$best.beta')
RPS17_output <- rename(RPS17_output, "RPS17_PES"="RPS17$best.beta", "A1"="A1.x", "SNP"="CHR:BP")
write.table(RPS17_output, file="~/Desktop/SZ_PES_mtCOJO_norm/Best_DA_gene_PES/SZ_best_con_or_lib/ASRB_excluded_SNP_weights_for_validation/ASRB_excluded_RPS17_PES_penalised_reg_weights.txt",
row.names = F, quote = F)
